## マイクロサービスとは

単一のアプリケーションを小さなサービス群の組み合わせとして構築する手法

黄金律は、「他は何も変更せずに、単独でサービスの変更やデプロイができるか」

#### メリット

1. サービスごとに適した技術を選択可能
2. 障害が起こっても、一部だけの損失で済む（モノリシックの場合、全てに影響が出る。）
3. スケールのしやすさ(一部の機能だけは、小規模で済ますなど)
4. 一部の機能だけリリースすることが可能
5. サービスの接合順序を自由に組み替えられる

#### 課題
- 複雑さ
  - 各サービスは単純だが、システム全体は複雑になる
- 統制の欠如
  - 異なる言語やフレームワークを使用するために、アプリの維持が難しくなる
- ネットワークの輻輳と待機時間
  - サービスの依存関係のチェーンによる待機時間がAPIの設計によって生じる可能性が大きい
- データ整合性
  - 各サービスで独自のデータ管理をするので、データの整合性を取るのが難しくなる
- 管理
  - 成熟したDevOpsカルチャが必要
- バージョン管理
  - 依存しているサービスを中断してはなならない
  - 複数のサービスが特定の時点で更新される場合があるため、下位互換/上位互換性に問題が生じる可能性がある
- チームのスキルセット
  - 高度なシステムなため、スキルや経験が大いに求められる

参考: [マイクロサービス アーキテクチャ スタイル
](https://docs.microsoft.com/ja-jp/azure/architecture/guide/architecture-styles/microservices)

### 他の分解テクニックとの違い

#### 共有ライブラリ

- 基本的に、同じ言語か少なくとも同じプラットフォームで動作する必要がある
- システムの各部を独立して、スケールできない
  - ライブラリをデプロイするには、全体のデプロイが必要

### 設計上の注意

#### 他のマイクロサービスが管理するDB内のデータが必要になる
データをやり取りする際は、直接DBにアクセスするのではなくデータをやり取りするAPIを用意する。

```
// 必要なデータがDBをまたぐ場合

NG
ServiceA -> DB2

OK
ServiceA -> ServiceB -> DB2
```